---
title: "Introduction to logistic regression"
author: "Dr. Olanrewaju Michael Akande"
date: "Sept 17, 2019"
output:
  xaringan::moon_reader:
    css: "slides.css"
    logo: img/class_logo.png
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r packages, echo=FALSE, message=FALSE, warning=FALSE}
#library(tidyverse)
#library(magick)
library(knitr)
library(kableExtra)
library(lattice)
#library(dplyr)
```

```{r setup, include=FALSE}
# R options
options(
  htmltools.dir.version = FALSE, # for blogdown
  #show.signif.stars = FALSE,     # for regression output
  warm = 1
  )
# Set dpi and height for images
knitr::opts_chunk$set(fig.height = 2.65,dpi =300,fig.align='center',fig.show='hold',size='footnotesize',small.mar=TRUE) 
# For nonsese...
htmltools::tagList(rmarkdown::html_dependency_font_awesome())
# For magick
dev.off <- function(){
  invisible(grDevices::dev.off())
}

knit_hooks$set(small.mar = function(before, options, envir) {
    if (before) par(mar =  c(4, 4, 1.5, 1.5)) 
})
```

## Announcements

- Final project outline now online; check the course schedule on the course website

- Modified office hours today


## Outline

- Questions from last lecture

- Relative risk and odds ratio

- Interpretating coefficients

- Model assessment

- Comparing multiple models



---
class: center, middle

# Relative risk and odds ratio



---
## Introduction

- So far in this course, our response variables have been continuous.

- Sometimes, we would also like to build models for binary outcome variables. For example,

  + $Y = 1$: healthy, $Y = 0$: not healthy
  + $Y = 1$: employed, $Y = 0$: not employed
  + $Y = 1$: win, $Y = 0$: lose

- Often, we want to predict or explain the binary outcome variable from several predictors.

- Linear regression is NOT appropriate, because normality for the response variable (and errors) makes no sense in this case.

- This brings us to .hlight[logistic regression], the most popular model for binary outcomes.

- First let's review relative risk, odds and odds ratios.



---
## Absolute risk and relative risk

- $Y$: binary response variable, $X$: binary predictor

<br />       | $Y=1$       | $Y=0$       |
:----------- | :---------: | :---------: |
$X=1$        | a           | b           |
$X=0$        | c           | d           |

- .hlight[Absolute risk] of $Y=1$ for level $X=1$: $\dfrac{a}{(a+b)}$

- .hlight[Absolute risk] of $Y=1$ for level $X=0$: $\dfrac{c}{(c+d)}$

- .hlight[Relative risk (RR)]: $\dfrac{a/(a+b)}{c/(c+d)}$



---
## Odds and odds ratio

- $Y$: binary response variable, $X$: binary predictor

<br />       | $Y=1$       | $Y=0$       |
:----------- | :---------: | :---------: |
$X=1$        | a           | b           |
$X=0$        | c           | d           |

- .hlight[Odds] of $Y=1$ for level $X=1$: $\dfrac{a}{b}$

- .hlight[Odds] of $Y=1$ for level $X=0$: $\dfrac{c}{d}$

- .hlight[Odds ratio (OR)]: $\dfrac{a/b}{c/d}$



---
## Probabilities and odds: motivating example

- Physicians' Health Study (1989): randomized experiment with 22071 male physicians at least 40 years old.

- Half the subjects were assigned to take aspirin every other day.

- The other half were assigned to take a placebo pill.

- Here are the number of people in each cell of the contingency table

<br />         | Heart attack  | No heart attack |
:------------- | :-----------: | :-------------: |
Aspirin        | 104           | 10933           |
Placebo        | 189           | 10845           |



---
## Absolute risk and relative risk for physicians health study

- Physicians Health Study

<br />         | Heart attack  | No heart attack |
:------------- | :-----------: | :-------------: |
Aspirin        | 104           | 10933           |
Placebo        | 189           | 10845           |

- .block[Relative risk of a heart attack when taking aspirin versus when taking a placebo equals]
$$\textrm{RR} = \dfrac{104/(104+10933)}{189/(189+10845)} = 0.55$$

- .block[Odds of having a heart attack when taking aspirin over odds of a heart attach when talking a placebo (odds ratio)]
$$\textrm{OR} = \dfrac{104/10933}{189/10845} = 0.546$$



---
## Interpreting odds ratios and relative risks

  <br />       | $Y=1$       | $Y=0$       |
:----------- | :---------: | :---------: |
$X=1$        | a           | b           |
$X=0$        | c           | d           |

- When the variables $X$ and $Y$ are independent 
$$OR = 1; \ \ \ \ \ \ \ \ \ RR = 1$$
  
- When subjects with level $X=1$ are more likely to have $Y=1$ than subjects with level $X=0$, then 
$$OR > 1; \ \ \ \ \ \ \ \ \ RR > 1$$
  
- When subjects with level $X=1$ are less likely to have $Y=1$ than subjects with level $X=0$, then 
$$OR < 1; \ \ \ \ \ \ \ \ \ RR < 1$$


---
## Relative risk vs. absolute risk: smoking and lung cancer

- Small or large values of relative risk may or may not be significant depending on the base rate.

- Thus, it can be more helpful or meaningful to present both the absolute risk and RR.

- For example,
  + Conservative estimate of the percentage of smokers who get lung cancer: 8%
  + Relative risk of lung cancer for smokers: 800%
  + That is, getting lung cancer is not commonplace, even for smokers but, smokers’chances of getting lung cancer are much, much higher than non-smokers’ chances.
  + The absolute risk helps place the RR in context.



